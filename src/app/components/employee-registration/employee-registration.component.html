<div class="employee-registration-container">
  <!-- Header -->
  <header class="employee-header">
    <div class="header-content">
      <div class="header-left">
        <!-- <button class="back-button" (click)="goBack()">
          <i class="fas fa-arrow-left"></i>
          <span>Volver</span>
        </button> -->
        <div class="header-title">
          <h1>Registro de Empleados</h1>
          <p>Gestión completa del personal de la empresa</p>
        </div>
      </div>
      
      <div class="header-actions">
        <button class="export-button" (click)="exportEmployees()">
          <i class="fas fa-download"></i>
          <span>Exportar</span>
        </button>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <main class="employee-main">
    <!-- Form Section -->
    <section class="form-section">
      <div class="form-container">
        <div class="form-header">
          <h2>{{ isEditing ? 'Editar Empleado' : 'Registrar Nuevo Empleado' }}</h2>
          <button *ngIf="isEditing" class="cancel-button" (click)="cancelEdit()">
            <i class="fas fa-times"></i>
            <span>Cancelar</span>
          </button>
        </div>

        <form [formGroup]="employeeForm" (ngSubmit)="onSubmit()" class="employee-form">
          <!-- Personal Information -->
          <div class="form-section-title">
            <i class="fas fa-user"></i>
            <h3>Información Personal</h3>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="personalEmail">Correo Personal *</label>
              <div class="input-container">
                <i class="fas fa-envelope"></i>
                <input 
                  type="email" 
                  id="personalEmail"
                  formControlName="personalEmail"
                  placeholder="empleado@email.com"
                >
              </div>
              <div class="error-message" *ngIf="employeeForm.get('personalEmail')?.invalid && employeeForm.get('personalEmail')?.touched">
                <span *ngIf="employeeForm.get('personalEmail')?.errors?.['required']">El correo es requerido</span>
                <span *ngIf="employeeForm.get('personalEmail')?.errors?.['email']">Email inválido</span>
              </div>
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="firstName">Nombre *</label>
              <div class="input-container">
                <i class="fas fa-user"></i>
                <input 
                  type="text" 
                  id="firstName"
                  formControlName="firstName"
                  placeholder="Nombre"
                >
              </div>
              <div class="error-message" *ngIf="employeeForm.get('firstName')?.invalid && employeeForm.get('firstName')?.touched">
                <span *ngIf="employeeForm.get('firstName')?.errors?.['required']">El nombre es requerido</span>
                <span *ngIf="employeeForm.get('firstName')?.errors?.['minlength']">Mínimo 2 caracteres</span>
              </div>
            </div>

            <div class="form-group">
              <label for="middleName">Apellido Paterno</label>
              <div class="input-container">
                <i class="fas fa-user"></i>
                <input 
                  type="text" 
                  id="middleName"
                  formControlName="middleName"
                  placeholder="Apellido Paterno"
                >
              </div>
            </div>

            <div class="form-group">
              <label for="lastName">Apellido Materno *</label>
              <div class="input-container">
                <i class="fas fa-user"></i>
                <input 
                  type="text" 
                  id="lastName"
                  formControlName="lastName"
                  placeholder="Apellido Materno"
                >
              </div>
              <div class="error-message" *ngIf="employeeForm.get('lastName')?.invalid && employeeForm.get('lastName')?.touched">
                <span *ngIf="employeeForm.get('lastName')?.errors?.['required']">El apellido es requerido</span>
                <span *ngIf="employeeForm.get('lastName')?.errors?.['minlength']">Mínimo 2 caracteres</span>
              </div>
            </div>
          </div>

          <!-- Official Documents -->
          <div class="form-section-title">
            <i class="fas fa-id-card"></i>
            <h3>Documentos Oficiales</h3>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="curp">CURP *</label>
              <div class="input-container">
                <i class="fas fa-id-card"></i>
                <input 
                  type="text" 
                  id="curp"
                  formControlName="curp"
                  placeholder="CURP (18 caracteres)"
                  maxlength="18"
                >
              </div>
              <div class="error-message" *ngIf="employeeForm.get('curp')?.invalid && employeeForm.get('curp')?.touched">
                <span *ngIf="employeeForm.get('curp')?.errors?.['required']">CURP requerido</span>
                <span *ngIf="employeeForm.get('curp')?.errors?.['pattern']">Formato CURP inválido</span>
              </div>
            </div>

            <div class="form-group">
              <label for="rfc">RFC *</label>
              <div class="input-container">
                <i class="fas fa-id-card"></i>
                <input 
                  type="text" 
                  id="rfc"
                  formControlName="rfc"
                  placeholder="RFC (13 caracteres)"
                  maxlength="13"
                >
              </div>
              <div class="error-message" *ngIf="employeeForm.get('rfc')?.invalid && employeeForm.get('rfc')?.touched">
                <span *ngIf="employeeForm.get('rfc')?.errors?.['required']">RFC requerido</span>
                <span *ngIf="employeeForm.get('rfc')?.errors?.['pattern']">Formato RFC inválido</span>
              </div>
            </div>

            <div class="form-group">
              <label for="nss">NSS *</label>
              <div class="input-container">
                <i class="fas fa-id-card"></i>
                <input 
                  type="text" 
                  id="nss"
                  formControlName="nss"
                  placeholder="NSS (11 dígitos)"
                  maxlength="11"
                >
              </div>
              <div class="error-message" *ngIf="employeeForm.get('nss')?.invalid && employeeForm.get('nss')?.touched">
                <span *ngIf="employeeForm.get('nss')?.errors?.['required']">NSS requerido</span>
                <span *ngIf="employeeForm.get('nss')?.errors?.['pattern']">NSS debe tener 11 dígitos</span>
              </div>
            </div>
          </div>

          <!-- Contact Information -->
          <div class="form-section-title">
            <i class="fas fa-phone"></i>
            <h3>Información de Contacto</h3>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="phoneNumber">Número de Teléfono *</label>
              <div class="input-container">
                <i class="fas fa-phone"></i>
                <input 
                  type="tel" 
                  id="phoneNumber"
                  formControlName="phoneNumber"
                  placeholder="10 dígitos"
                  maxlength="10"
                >
              </div>
              <div class="error-message" *ngIf="employeeForm.get('phoneNumber')?.invalid && employeeForm.get('phoneNumber')?.touched">
                <span *ngIf="employeeForm.get('phoneNumber')?.errors?.['required']">Teléfono requerido</span>
                <span *ngIf="employeeForm.get('phoneNumber')?.errors?.['pattern']">Debe tener 10 dígitos</span>
              </div>
            </div>

            <div class="form-group">
              <label for="postalCode">Código Postal *</label>
              <div class="input-container">
                <i class="fas fa-map-marker-alt"></i>
                <input 
                  type="text" 
                  id="postalCode"
                  formControlName="postalCode"
                  placeholder="5 dígitos"
                  maxlength="5"
                >
              </div>
              <div class="error-message" *ngIf="employeeForm.get('postalCode')?.invalid && employeeForm.get('postalCode')?.touched">
                <span *ngIf="employeeForm.get('postalCode')?.errors?.['required']">Código postal requerido</span>
                <span *ngIf="employeeForm.get('postalCode')?.errors?.['pattern']">Debe tener 5 dígitos</span>
              </div>
            </div>
          </div>

          <div class="form-group">
            <label for="address">Dirección *</label>
            <div class="input-container">
              <i class="fas fa-map-marker-alt"></i>
              <input 
                type="text" 
                id="address"
                formControlName="address"
                placeholder="Dirección completa"
              >
            </div>
            <div class="error-message" *ngIf="employeeForm.get('address')?.invalid && employeeForm.get('address')?.touched">
              <span *ngIf="employeeForm.get('address')?.errors?.['required']">Dirección requerida</span>
              <span *ngIf="employeeForm.get('address')?.errors?.['minlength']">Mínimo 10 caracteres</span>
            </div>
          </div>

          <!-- Work Information -->
          <div class="form-section-title">
            <i class="fas fa-briefcase"></i>
            <h3>Información Laboral</h3>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="department">Departamento *</label>
              <div class="input-container">
                <i class="fas fa-building"></i>
                <select id="department" formControlName="department">
                  <option value="">Seleccionar departamento</option>
                  <option *ngFor="let dept of departments" [value]="dept">
                    {{ dept }}
                  </option>
                </select>
              </div>
              <div class="error-message" *ngIf="employeeForm.get('department')?.invalid && employeeForm.get('department')?.touched">
                <span *ngIf="employeeForm.get('department')?.errors?.['required']">Departamento requerido</span>
              </div>
            </div>

            <div class="form-group">
              <label for="position">Puesto *</label>
              <div class="input-container">
                <i class="fas fa-user-tie"></i>
                <select id="position" formControlName="position">
                  <option value="">Seleccionar puesto</option>
                  <option *ngFor="let pos of positions" [value]="pos">
                    {{ pos }}
                  </option>
                </select>
              </div>
              <div class="error-message" *ngIf="employeeForm.get('position')?.invalid && employeeForm.get('position')?.touched">
                <span *ngIf="employeeForm.get('position')?.errors?.['required']">Puesto requerido</span>
              </div>
            </div>

            <div class="form-group">
              <label for="employeeNumber">Número de Empleado *</label>
              <div class="input-container">
                <i class="fas fa-hashtag"></i>
                <input 
                  type="text" 
                  id="employeeNumber"
                  formControlName="employeeNumber"
                  placeholder="4-6 dígitos"
                  maxlength="6"
                >
              </div>
              <div class="error-message" *ngIf="employeeForm.get('employeeNumber')?.invalid && employeeForm.get('employeeNumber')?.touched">
                <span *ngIf="employeeForm.get('employeeNumber')?.errors?.['required']">Número de empleado requerido</span>
                <span *ngIf="employeeForm.get('employeeNumber')?.errors?.['pattern']">Debe tener 4-6 dígitos</span>
              </div>
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="startDate">Fecha de Inicio *</label>
              <div class="input-container">
                <i class="fas fa-calendar"></i>
                <input 
                  type="date" 
                  id="startDate"
                  formControlName="startDate"
                >
              </div>
              <div class="error-message" *ngIf="employeeForm.get('startDate')?.invalid && employeeForm.get('startDate')?.touched">
                <span *ngIf="employeeForm.get('startDate')?.errors?.['required']">Fecha de inicio requerida</span>
              </div>
            </div>

            <div class="form-group">
              <label for="endDate">Fecha de Fin (opcional)</label>
              <div class="input-container">
                <i class="fas fa-calendar-times"></i>
                <input 
                  type="date" 
                  id="endDate"
                  formControlName="endDate"
                >
              </div>
            </div>

            <div class="form-group">
              <label for="salary">Salario *</label>
              <div class="input-container">
                <i class="fas fa-dollar-sign"></i>
                <input 
                  type="number" 
                  id="salary"
                  formControlName="salary"
                  placeholder="0.00"
                  step="0.01"
                  min="0.01"
                >
              </div>
              <div class="error-message" *ngIf="employeeForm.get('salary')?.invalid && employeeForm.get('salary')?.touched">
                <span *ngIf="employeeForm.get('salary')?.errors?.['required']">Salario requerido</span>
                <span *ngIf="employeeForm.get('salary')?.errors?.['min']">Debe ser mayor a 0</span>
              </div>
            </div>
          </div>

          <div class="form-actions">
            <button type="submit" class="submit-button" [disabled]="employeeForm.invalid">
              <i class="fas fa-save"></i>
              <span>{{ isEditing ? 'Actualizar' : 'Registrar' }} Empleado</span>
            </button>
            
            <button type="button" class="reset-button" (click)="resetForm()" *ngIf="!isEditing">
              <i class="fas fa-undo"></i>
              <span>Limpiar</span>
            </button>
          </div>
        </form>
      </div>
    </section>

    <!-- Employees List -->
    <section class="employees-section">
      <div class="section-header">
        <h3>Lista de Empleados</h3>
        <div class="list-actions">
          <div class="search-container">
            <i class="fas fa-search"></i>
            <input 
              type="text" 
              placeholder="Buscar empleados..."
              (input)="onSearchInput($event)"
            >
          </div>
        </div>
      </div>

      <div class="employees-list">
        <div 
          class="employee-item" 
          *ngFor="let employee of filteredEmployees"
          [class]="'employee-' + employee.status"
        >
          <div class="employee-avatar">
            <i class="fas fa-user"></i>
          </div>
          
          <div class="employee-content">
            <div class="employee-header">
              <h4>{{ getFullName(employee) }}</h4>
              <span class="employee-number">#{{ employee.employeeNumber }}</span>
            </div>
            
            <div class="employee-details">
              <div class="detail-row">
                <span class="detail-label">Email:</span>
                <span class="detail-value">{{ employee.personalEmail }}</span>
              </div>
              
              <div class="detail-row">
                <span class="detail-label">Departamento:</span>
                <span class="detail-value">{{ employee.department }}</span>
              </div>
              
              <div class="detail-row">
                <span class="detail-label">Puesto:</span>
                <span class="detail-value">{{ employee.position }}</span>
              </div>
              
              <div class="detail-row">
                <span class="detail-label">Salario:</span>
                <span class="detail-value salary">{{ formatCurrency(employee.salary) }}</span>
              </div>
              
              <div class="detail-row">
                <span class="detail-label">Fecha Inicio:</span>
                <span class="detail-value">{{ formatDate(employee.startDate) }}</span>
              </div>
            </div>
            
            <div class="employee-status">
              <span class="status-badge" [class]="'status-' + getStatusColor(employee.status)">
                {{ getStatusText(employee.status) }}
              </span>
            </div>
          </div>
          
          <div class="employee-actions">
            <button class="action-button edit" (click)="editEmployee(employee)" title="Editar">
              <i class="fas fa-edit"></i>
            </button>
            
            <button class="action-button toggle" (click)="toggleEmployeeStatus(employee)" title="Cambiar estado">
              <i [class]="employee.status === 'active' ? 'fas fa-pause' : 'fas fa-play'"></i>
            </button>
            
            <button class="action-button delete" (click)="deleteEmployee(employee.id)" title="Eliminar">
              <i class="fas fa-trash"></i>
            </button>
          </div>
        </div>
        
        <div class="no-employees" *ngIf="filteredEmployees.length === 0">
          <i class="fas fa-users"></i>
          <p>No hay empleados registrados</p>
        </div>
      </div>
    </section>
  </main>
</div> 