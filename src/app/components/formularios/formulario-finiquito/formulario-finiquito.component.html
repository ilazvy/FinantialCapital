<div class="formulario-finiquito-container">
  <!-- Header -->
  <header class="form-header">
    <div class="header-content">
      <div class="header-left">
        <div class="header-title">
          <h1>Registro de Finiquitos</h1>
          <p>Gestiona el pago de finiquitos e indemnizaciones de manera profesional</p>
        </div>
      </div>
      <div class="header-actions">
        <button class="export-button" (click)="exportFiniquitos()">
          <i class="fas fa-download"></i>
          <span>Exportar</span>
        </button>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <main class="form-main">
    <div class="form-grid">
      <!-- Finiquito Form -->
      <div class="form-section">
        <div class="form-card">
          <div class="form-card-header">
            <i class="fas fa-hand-holding-usd"></i>
            <h3>Nuevo Finiquito</h3>
          </div>
          <form [formGroup]="finiquitoForm" (ngSubmit)="onSubmit()">
            <!-- Campos del formulario -->
            <div class="form-row">
              <div class="form-group">
                <label for="department">Departamento *</label>
                <div class="input-container">
                  <i class="fas fa-building"></i>
                  <select id="department" formControlName="department" (change)="onDepartmentChange($event)">
                    <option value="">Seleccionar departamento</option>
                    <option *ngFor="let dept of departments" [value]="dept">{{ dept }}</option>
                  </select>
                </div>
              </div>
              <div class="form-group">
                <label for="employeeId">Empleado *</label>
                <div class="input-container">
                  <i class="fas fa-user"></i>
                  <select id="employeeId" formControlName="employeeId" (change)="onEmpleadoChange($event)" [disabled]="!empleadosFiltrados.length">
                    <option value="">Seleccionar empleado</option>
                    <option *ngFor="let emp of empleadosFiltrados" [value]="emp.id">{{ emp.name }}</option>
                  </select>
                </div>
              </div>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label for="sueldoBase">Sueldo base</label>
                <div class="input-container">
                  <i class="fas fa-dollar-sign"></i>
                  <input id="sueldoBase" formControlName="sueldoBase" readonly>
                </div>
              </div>
              <div class="form-group">
                <label for="fechaIngreso">Fecha de ingreso</label>
                <div class="input-container">
                  <i class="fas fa-calendar-alt"></i>
                  <input id="fechaIngreso" formControlName="fechaIngreso" readonly>
                </div>
              </div>
              <div class="form-group">
                <label for="fechaBaja">Fecha de baja *</label>
                <div class="input-container">
                  <i class="fas fa-calendar"></i>
                  <input type="date" id="fechaBaja" formControlName="fechaBaja" (change)="onFechaBajaChange($event)">
                </div>
              </div>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label for="motivo">Motivo de baja *</label>
                <div class="input-container">
                  <i class="fas fa-question-circle"></i>
                  <select id="motivo" formControlName="motivo">
                    <option value="">Seleccionar motivo</option>
                    <option *ngFor="let m of motivos" [value]="m.value">{{ m.label }}</option>
                  </select>
                </div>
              </div>
              <div class="form-group">
                <label for="diasLaborados">Días laborados</label>
                <div class="input-container">
                  <i class="fas fa-hourglass-half"></i>
                  <input id="diasLaborados" formControlName="diasLaborados" readonly>
                </div>
              </div>
              <div class="form-group">
                <label for="montoFiniquito">Monto de finiquito</label>
                <div class="input-container">
                  <i class="fas fa-coins"></i>
                  <input id="montoFiniquito" formControlName="montoFiniquito" readonly>
                </div>
              </div>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label for="paymentMethod">Método de pago *</label>
                <div class="input-container">
                  <i class="fas fa-money-bill-wave"></i>
                  <select id="paymentMethod" formControlName="paymentMethod">
                    <option *ngFor="let method of paymentMethods" [value]="method.value">{{ method.label }}</option>
                  </select>
                </div>
              </div>
              <div class="form-group">
                <label for="reference">Referencia</label>
                <div class="input-container">
                  <i class="fas fa-hashtag"></i>
                  <input id="reference" formControlName="reference" placeholder="Número de referencia">
                </div>
              </div>
            </div>
            <div class="form-group">
              <label for="description">Descripción *</label>
              <div class="input-container">
                <i class="fas fa-comment"></i>
                <textarea id="description" formControlName="description" rows="3" placeholder="Descripción detallada del finiquito"></textarea>
              </div>
            </div>
            <div class="form-group">
              <label for="notes">Notas adicionales</label>
              <div class="input-container">
                <i class="fas fa-sticky-note"></i>
                <textarea id="notes" formControlName="notes" rows="2" placeholder="Notas adicionales o comentarios"></textarea>
              </div>
            </div>
            <div class="form-actions">
              <button type="submit" class="btn-primary" [disabled]="finiquitoForm.invalid">
                <i class="fas fa-save"></i>
                <span>Registrar Finiquito</span>
              </button>
              <button type="button" class="btn-secondary" (click)="finiquitoForm.reset({ paymentMethod: 'bank_transfer' })">
                <i class="fas fa-undo"></i>
                <span>Limpiar</span>
              </button>
            </div>
          </form>
        </div>
      </div>
      <!-- Finiquito History -->
      <div class="history-section">
        <div class="history-card">
          <div class="history-header">
            <h3>Historial de Finiquitos</h3>
            <div class="history-actions">
              <button class="btn-toggle" (click)="toggleFiniquitoHistory()">
                <i class="fas" [class.fa-eye]="!showFiniquitoHistory" [class.fa-eye-slash]="showFiniquitoHistory"></i>
                <span>{{ showFiniquitoHistory ? 'Ocultar' : 'Mostrar' }}</span>
              </button>
            </div>
          </div>
          <div class="search-section">
            <div class="input-container">
              <i class="fas fa-search"></i>
              <input 
                type="text" 
                placeholder="Buscar finiquitos..."
                (input)="searchFiniquitos($event)"
              >
            </div>
          </div>
          <div class="payment-list" *ngIf="showFiniquitoHistory">
            <div class="payment-item" *ngFor="let finiquito of filteredFiniquitos">
              <div class="payment-header">
                <div class="payment-info">
                  <h4>{{ finiquito.employeeName }}</h4>
                  <p>{{ finiquito.description }}</p>
                  <div class="payment-meta">
                    <span class="payment-type">{{ getMotivoLabel(finiquito.motivo) }}</span>
                    <!-- <span class="payment-method">{{ getPaymentMethodLabel(finiquito.paymentMethod) }}</span> -->
                    <span class="payment-date">{{ finiquito.fechaBaja }}</span>
                  </div>
                </div>
                <div class="payment-amount">
                  <span class="amount">{{ finiquito.montoFiniquito | currency:'MXN' }}</span>
                  <span class="status" [class]="'status-' + getStatusColor(finiquito.status)">
                    {{ getStatusText(finiquito.status) }}
                  </span>
                </div>
              </div>
              <div class="payment-actions">
                <button 
                  class="btn-action" 
                  *ngIf="finiquito.status === 'pending'"
                  (click)="updateFiniquitoStatus(finiquito.id, 'completed')"
                  title="Marcar como completado"
                >
                  <i class="fas fa-check"></i>
                </button>
                <button 
                  class="btn-action danger" 
                  (click)="updateFiniquitoStatus(finiquito.id, 'cancelled')"
                  title="Cancelar finiquito"
                >
                  <i class="fas fa-times"></i>
                </button>
                <button 
                  class="btn-action secondary" 
                  (click)="deleteFiniquito(finiquito.id)"
                  title="Eliminar finiquito"
                >
                  <i class="fas fa-trash"></i>
                </button>
              </div>
            </div>
            <div class="no-payments" *ngIf="filteredFiniquitos.length === 0">
              <i class="fas fa-inbox"></i>
              <p>No se encontraron finiquitos</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>
</div>
